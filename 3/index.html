
<!DOCTYPE html>
<html>
<head>
    <title>Project 3</title>
    <style>
        body {
            font-family: Times New Roman, Arial, sans-serif;
            margin: 20px;
        }

        <!-- Following code for CSS style is adapted from W3 Schools. https://www.w3schools.com/howto/howto_css_images_side_by_side.asp
        and Stack Overflow
        https://stackoverflow.com/questions/61637178/how-to-center-multiple-figure-elements-in-one-row-->
        * {
      box-sizing: border-box;
    }
    
    .column {
      float: left;
      width: 50%;
      padding: 5px;
    }
    
    
    .row {
      padding-bottom: 50px;
      display: flex;
        text-align: center;
        flex-direction: row;
        justify-content: center;
    }

    img {
        width: 100%;
        height: auto
        
    }
    </style>
</head>
<body>
    <h1>Welcome to My CS180 Project 3!</h1>
    <a href = "../index.html"> My CS180 Personal Project Home Page </a>
    <strong> <br> Name: Zach Turner <br> SID: 3036700008 </strong>
    <h3>Introduction</h3>
  <p>
    This project explores working with changing pixel domains and pixel values in visual data. In particular, this project focuses on working with facial images with transformations such as morphs, warp-dissolves, cross-dissolves, caricutares, and facial averaging. 
  </p>

  <h3>Part 1 - Correspondances </h3>
<p>
  Throughout this project, we will being doing various manipulations that involving combining different faces in some manner. One issue with this is that different people have facial features in different locations in the image due to either the perspective the image was taken from or because humans fundmentally have different locations for facial features relative to where their other features are. Thus, we need some way to put faces into a standard location of features when combining them. To do this, we use correspondances. Correspondances are data that define where certain notable facial characteristics lie in the image. 

  Throughout this project, I will be working a lot with combining two particular photos: one of George Clooney from the Martin Schoeller collection, and another of myself taken from a similar perspective with equivalent dimensions. 
</p>

  <div class = "row">
      <figure>
        <img src = "./media/me.jpg">
          <figcaption>Myself</figcaption>
      </figure>
      <figure>
        <img src = "./media/george.jpg">
          <figcaption>George Clooney</figcaption>
      </figure>
  </div>

    <p>
        I defined a correspondance for these two images using the tool provided by course staff. <a href = "https://cal-cs180.github.io/fa23/hw/proj3/tool.html"> tool </a>
        For these two images, I selected 80 points of correspondance. I later added a point of correspondance for each corner to improve morphing, bringing the total number of correspondances to 84. 
        <br><br>
        One challenge I found later on when using these correspondances is that the tool gives the points of correspondance with x, y values flipped compared to how numpy stores images. Thus, I flip the x, y coordinates of correspondance points after I load them in. This is a result of that many applications in the image sphere track image locations in opposite manner to how images are stored. Finding this took a lot of debugging and was something that required constant attention throughout the project. For example, I would have to flip the x, y coordinates of points back when plotting them on images, since that is how plotting software expects them. 

        <br><br>
        Given these points of correspondance, we compute a Delaunay triangulation, which provides the optimal triangulation to allow me to morph each area of the image together independently. Since we are using the triangulation to morph images into an average shape, we calculate it using the average location of each correspondance so that the triangulation is stable in the position we are going to use it in. Below are both of the images showing the points of correspondance and Delaunay triangulation.
    </p>

    <div class = "row">
      <figure>
        <img src = "./media/meTri.png">
          <figcaption>Myself With My Correspondance Points and Triangulation</figcaption>
      </figure>
      <figure>
        <img src = "./media/georgeTri.png">
          <figcaption>George Clooney With His Correspondance Points and Triangulation</figcaption>
      </figure>
  </div>

<h3>Part 2 - Mid-way Image</h3>
    <p>
        In this section, I am computing the "mid-way" image of myself and George Clooney. This first involves computing the average shape of our two faces, which we define as the average location of each correspondance point. Then I will map each face into that shape, and average the colors from each of our faces. 
        <br><br>
        The most difficult part of the whole project is to figure out how to morph two images into a common shape. My approach maps each face to the mid-way face independently for each triangle in the triangulation. Our theory is that for triangle, the midway image is some affine transformation of the original image. Thus, we need to determine the affine transformation of the original image triangle's location that finds the location of the corresponding triangle in the midway image. Given the degrees of freedom of an affine transformation, the three points that define the triangle's location in the original and midway image suffice to find the transformation. This gives us a linear system, that we need to solve to determine the coeffcients of the transformation. This is what my computeAffine function does
    </p>
</body>
</html>
